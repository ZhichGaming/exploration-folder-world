<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&display=swap" rel="stylesheet">  
    <style>
        body {
            padding: 0;
            margin: 0;
        }

        .root {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            flex-direction: column;
        }

        .events-container {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
            /* display: flex; */
        }

        .hidden {
            display: none;
        }

        .fade-in {
            animation: fade-in ease-out 0.5s;
        }

        @keyframes fade-in {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .event {
            width: 100%;
            height: 100%;
            position: absolute;
            display: flex;
            background-color: #313131;
            color: white;
            transition: all 0.5s ease-in-out;
            /* transform: translate(0); */
            /* opacity: 1; */
        }

        .event-displaced-left {
            transform: translateX(-100vw);
        }

        .event-displaced-right {
            transform: translateX(100vw);
        }

        .navigation-area {
            height: 100%;
            flex: 1 1 auto;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 15px;
            font-family: "Playfair Display", serif;
            font-size: 20px;
            font-weight: 700;
        }

        .left-area {
            text-align: left;
        }

        .right-area {
            text-align: right;
            justify-content: flex-end;
        }

        .background-image {
            width: 100%;
            height: 100%;
            opacity: 0.2;
            position: absolute;
            pointer-events: none;
            /* z-index: -1; */
        }

        .info-area {
            height: 100%;
            width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-family: 'Space Grotesk', sans-serif;
        }

        .year {
            font-family: "Playfair Display", serif;
            font-size: 80px;
            font-weight: 700;
            margin: 10px;
        }

        .description {
            opacity: 0.8;
            font-weight: 100;
            font-size: 15px;
        }

        .toc {
            position: fixed;
            /* width: 100vw; */
            /* height: 95vh; */
            bottom: 50px;
            display: flex;
            justify-content: center;
            align-items: end;
        }

        .toc-circle {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid white;
            display: flex;
            cursor: pointer;
            justify-content: center;
            white-space: nowrap;
            transition: background-color 0.2s;
            overflow: visible;
        }

        .toc-circle:hover {
            background-color: white;
        }

        .toc-circle-selected {
            background-color: white;
        }

        .toc-date {
            transform: translateY(15px);
            text-align: center;
            color: white;
            font-family: "Space Grotesk", sans-serif;
            font-weight: 200;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="root">
        <div id="events-container" class="events-container">
            <div id="active-event" class="event">
                <img class="background-image" src="https://picsum.photos/1600/900">
                <div id="left-area" class="navigation-area left-area" onclick="clickLeft()"></div>
                <div class="info-area">                    
                    <p class="title">HEY, THIS IS A TITLE</p>
                    <p class="year">1600</p>
                    <p class="description">Lorem ipsum dolor sit amet, consectetur adipiscing elit. In porttitor malesuada neque, ut aliquam neque. Morbi pretium elementum nisi at interdum. Ut dignissim blandit bibendum. Phasellus commodo mi ut ante scelerisque egestas. Sed non nulla ac nunc dignissim semper non sit amet magna. Curabitur vitae nibh eget ipsum feugiat feugiat non in est. Donec at ex suscipit velit congue faucibus egestas nec lectus. Cras in pretium nibh. Cras tellus mi, hendrerit sit amet tincidunt sit amet, gravida nec dui. Nunc eget orci non ex aliquam elementum nec a turpis. Quisque vel aliquam sapien. Nam in rutrum erat, nec laoreet est. Duis congue lorem sit amet interdum viverra. In posuere elementum nisl eget viverra.</p>
                </div>
                <div id="right-area" class="navigation-area right-area" onclick="clickRight()"></div>
            </div>
        </div>
        <div id="toc" class="toc">

        </div>
    </div>
    <script>
        const events = [
            {
                date: new Date(1949, 9, 1), // October 1, 1949
                title: "PCC gagne la guerre civile chinoise",
                description: "L'Armée populaire de libération a pris lentement le contrôle des villes chinoises. Son but, prendre en charge la capitale, Beijing. Après une longue guerre, Mao Zedong a déclaré sur le balcon du Tien'anmen, également connu sous le nom de 'la porte de la Paix céleste', la victoire du Parti communiste. Le Kuomintang s'est replié sur l'île de Taïwan, où il y est encore de nos jours.",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1950, 0, 1), // January 1950
                title: "Guerre de Corée",
                description: "1950-1953: La Chine soutient la Corée du Nord dans la guerre de Corée, s'opposant aux forces des Nations Unies menées par les États-Unis.",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1958, 0, 1), // January 1958
                title: "Grand Bond en avant",
                description: "Ce projet a été lancé par Mao Zedong afin de développer le socialisme en Chine suite aux difficultés à suivre le modèle russe, qui avait une économie planifiée. Ce plan s'agit de s'appuyer sur les paysans plutôt que la population urbaine. Le gouvernement va encourager les paysans à quitter leurs exploitations pour fournir la main-d'œuvre à la production de fer et d'acier. De plus, le gouvernement taxe les productions agricoles de chaque famille, ce qui réduit les surplus pour nourrir ces villageois. Cet événement a directement causé la Grande Famine Chinoise.",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1959, 0, 1), // 1959-1961
                title: "Grande famine chinoise",
                description: "La Chine a connu la famille la plus meurtrière dans l'histoire de l'humanité. Le nombre de décès total varie de 15 millions à 55 millions. Cette famine a été causée par le Grand Bond en avant de Mao Zedong. Il voulait augmenter la production de fer et d'acier afin de pouvoir industrialiser le pays, donc il envoie les paysans en ville pour pouvoir travailler dans les usines. Les familles de paysans, même après cet événement, doivent continuer de produire des céréales pour se nourrir et pour les donner au gouvernement, qui les exportent à d'autres pays. Liu Shaoqi, un membre influent du parti communiste chinois,  s'exprime de façon négative envers Mao après avoir visité sa région natale et compris la gravité de la situation. En effet,  Mao Zedong n'arrêtait pas les exportations même pendant le pire moment de la crise. Il y eut même des cas de cannibalisme, puisque les gens utilisaient tous les recours possibles pour survivre.",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1966, 0, 1), // January 1966
                title: "Révolution culturelle",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1971, 9, 25), // October 25, 1971
                title: "La république populaire de Chine est admise dans l'ONU",
                description: "Remplaçant la république de Chine (Taiwan actuel).",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1976, 6, 28), // July 28, 1976
                title: "Séisme de Tangshan",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1980, 8, 18), // September 18, 1980
                title: "Mise en place de la politique de l'enfant unique",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1989, 5, 4), // June 4, 1989
                title: "Massacre de Tiananmen",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1992, 0, 1), // January 1992
                title: "Tournée d'inspection de Deng Xiaoping dans le sud",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1998, 0, 1), // January 1998
                title: "Le projet du Grand Pare-feu de Chine débute",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(1999, 11, 20), // December 20, 1999
                title: "Le gouvernement regagne le contrôle de Macau",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(2001, 10, 10), // November 10, 2001
                title: "République populaire de Chine rejoint l'OMC",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(2008, 7, 8), // August 8, 2008
                title: "Cérémonie d'ouverture des Jeux olympiques d'été",
                description: "Pour la première fois, la Chine devient le pays hôte des jeux olympiques.",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(2014, 0, 1), // January 2014
                title: "La Chine devient la deuxième économie mondiale",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(2018, 2, 1), // March 2018
                title: "Xi Jinping élimine la limite du nombre de mandats",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(2019, 11, 1), // December 2019
                title: "Premier cas de COVID-19 au Wuhan",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            },
            {
                date: new Date(2021, 6, 1), // July 1, 2021
                title: "Le 100ème anniversaire du PCC",
                description: "",
                backgroundURL: "https://picsum.photos/1600/900",
            }
        ];


        let activeEvent = document.getElementById("active-event");
        const eventsContainer = document.getElementById("events-container");

        let currentEventIndex = 0;

        function getNextEventIndex(by = 1) {
            const newIndex = currentEventIndex + by;
            return (newIndex < 0 ? newIndex + events.length : newIndex) % events.length;
        }

        function setEvent(eventIndex) {
            const event = events[eventIndex];

            const title = activeEvent.querySelector(".title");
            const year = activeEvent.querySelector(".year");
            const description = activeEvent.querySelector(".description");
            const backgroundImage = activeEvent.querySelector(".background-image");

            title.innerText = event.title;
            year.innerText = event.date.getFullYear();
            description.innerText = event.description;
            backgroundImage.src = event.backgroundURL;

            activeEvent.querySelector("#left-area").innerText = "< " + events[getNextEventIndex(-1)].date.getFullYear();
            activeEvent.querySelector("#right-area").innerText = events[getNextEventIndex()].date.getFullYear() + " >";

            for (let index = 0; index < document.getElementById("toc").children.length; index++) {
                const tocItem = document.getElementById("toc").children[index]

                tocItem.classList.remove("toc-circle-selected");
            }

            if (document.getElementById("toc").children.length > 0) {
                document.getElementById("toc").children[currentEventIndex*2].classList.add("toc-circle-selected");
            }
        }

        function createTOC() {
            const toc = document.getElementById("toc");

            events.forEach((event, index) => {
                const tocItem = document.createElement("div");
                // tocItem.innerText = event.date.getFullYear();
                tocItem.classList.add("toc-circle")

                const dateItem = document.createElement("p");
                dateItem.innerText = event.date.getFullYear();
                dateItem.classList.add("toc-date")

                tocItem.appendChild(dateItem)

                tocItem.addEventListener("click", () => {
                    if (index === currentEventIndex) return;

                    const newEventElement = getClonedEvent();

                    eventsContainer.appendChild(newEventElement)

                    if (index < currentEventIndex) activeEvent.classList.add("event-displaced-right")
                    else if (index > currentEventIndex) activeEvent.classList.add("event-displaced-left")

                    currentEventIndex = index;

                    changeActiveEvent(newEventElement);
                })

                toc.appendChild(tocItem);

                if (index !== events.length - 1) {
                    const separator = document.createElement("hr");
                    separator.style.width = "20px";
                    separator.style.border = "2px solid white";
                    toc.appendChild(separator);
                }
            })
        }

        createTOC();

        setEvent(0);

        function getClonedEvent() {
            const newEventElement = activeEvent.cloneNode(true);
            newEventElement.classList.add("no-opacity")
            return newEventElement;
        }

        function changeActiveEvent(newEventElement) {
            activeEvent.removeAttribute("id")

            const previousActiveEvent = activeEvent;
            activeEvent = document.getElementById("active-event")
            
            setEvent(currentEventIndex);

            newEventElement.classList.add("fade-in");

            previousActiveEvent.addEventListener("transitionend", () => {
                previousActiveEvent.remove();
            })
        }

        function clickLeft() {
            currentEventIndex = getNextEventIndex(-1);            
            const newEventElement = getClonedEvent();

            eventsContainer.appendChild(newEventElement)

            activeEvent.classList.add("event-displaced-right")
            changeActiveEvent(newEventElement);
        }

        function clickRight() {
            currentEventIndex = getNextEventIndex();

            const newEventElement = getClonedEvent();

            eventsContainer.appendChild(newEventElement)

            activeEvent.classList.add("event-displaced-left")
            changeActiveEvent(newEventElement);
        }
    </script>
</body>
</html>
